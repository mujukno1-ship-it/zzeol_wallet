<!-- 🔥 사토시의지갑 v10.0 완전체 (SPARK + ULTRA + PrecisionBoost) -->
<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>사토시의지갑 v10.0</title>
<style>
body{background:#0b0c10;color:#fff;font-family:'Pretendard',sans-serif;margin:0;overflow-x:hidden;}
header{position:fixed;top:0;left:0;width:100%;background:#101217;padding:10px 12px;z-index:999;display:flex;flex-direction:column;align-items:center;border-bottom:1px solid #222;}
#search-box{width:90%;max-width:480px;height:46px;font-size:16px;padding:0 12px;border:none;border-radius:10px;background:#1b1d23;color:#fff;outline:none;}
#results{width:90%;max-width:480px;background:#1a1c20;margin-top:6px;border-radius:10px;overflow:hidden;max-height:210px;transition:max-height .3s ease;}
.result-item{padding:10px;border-bottom:1px solid #222;font-size:15px;cursor:pointer;}
.result-item:hover{background:#2a2c30;}
.spark-section{margin-top:110px;padding:10px 0;text-align:center;}
.spark-title{font-size:18px;margin-bottom:4px;}
.spark-item{display:inline-block;background:#191b20;padding:6px 12px;border-radius:10px;margin:4px;font-size:14px;}
.spark-heat{font-weight:bold;}
.signal-panel{width:90%;max-width:480px;background:#101217;margin:12px auto;padding:12px;border-radius:12px;line-height:1.6;border:1px solid #222;}
.zzeol-comment{font-style:italic;color:#f9d65c;}
</style>
</head>
<body>
<header>
<input id="search-box" placeholder="코인 이름 또는 심볼 입력..." />
<div id="results"></div>
</header>

<section class="spark-section">
  <div class="spark-title">🔥 SPARK TOP10 — 급등 사전 예열 감지</div>
  <div id="spark-list">불러오는 중...</div>
</section>

<div id="signal-output" class="signal-panel" style="display:none;"></div>

<script>
/* ===========================
   ⚙️ 사토시의지갑 v10.0 완전체
   SPARK + ULTRA + PrecisionBoost + NoMotion
   =========================== */

// API 기본 설정
const API_BASE = "https://satoshi-proxy.mujukno1.workers.dev/api";
const searchBox = document.getElementById("search-box");
const results = document.getElementById("results");
const sparkList = document.getElementById("spark-list");
const signalPanel = document.getElementById("signal-output");

// No-Motion 모드
results.style.transition="none";

// 🔍 실시간 코인 검색
searchBox.addEventListener("input", async (e)=>{
  const q = e.target.value.trim();
  if(!q){results.innerHTML="";return;}
  try{
    const r = await fetch(`${API_BASE}/search?q=${encodeURIComponent(q)}`);
    const data = await r.json();
    const coins = (data||[]).slice(0,5);
    results.innerHTML = coins.map(c=>`
      <div class="result-item" data-symbol="${c.symbol}">
        ${c.korean_name} (${c.symbol}) — ${c.price.toLocaleString()}원
      </div>`).join("");
  }catch(err){
    results.innerHTML=`<div class="result-item">검색 오류</div>`;
  }
});

// ✅ SPARK TOP10 표시
async function loadSpark(){
  try{
    const r = await fetch(`${API_BASE}/spark`);
    const data = await r.json();
    sparkList.innerHTML = data.map(c=>{
      const color = c.score>=90?"#ff4d4d":c.score>=80?"#ff9900":"#888";
      return `<div class="spark-item" data-symbol="${c.symbol}">
        ${c.korean_name} <span class="spark-heat" style="color:${color}">(${c.score})</span>
      </div>`;
    }).join("");
  }catch(err){
    sparkList.innerHTML="연결 실패";
  }
}
loadSpark();

// 🧠 SPARK → ULTRA 시그널
document.addEventListener("click",async(e)=>{
  const item=e.target.closest(".spark-item,.result-item");
  if(!item)return;
  const sym=item.dataset.symbol;
  signalPanel.style.display="block";
  signalPanel.innerHTML="AI 분석중...";
  try{
    const r = await fetch(`${API_BASE}/ultra?symbol=${sym}`);
    const s = await r.json();
    signalPanel.innerHTML=`
      <b>${s.korean_name} (${s.symbol})</b><br>
      현재가: ${s.price}원<br>
      매수: ${s.buy1}원 / 익절: ${s.tp1}원 / 손절: ${s.sl}원<br>
      위험도: ${s.risk}<br>
      <span class="zzeol-comment">${s.comment}</span>
    `;
  }catch(err){
    signalPanel.innerHTML="데이터 로드 실패";
  }
});

// 🔁 30초마다 SPARK 업데이트
setInterval(loadSpark,30000);
</script>
</body>
</html>
