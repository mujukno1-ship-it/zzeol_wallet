<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>ì‚¬í† ì‹œì˜ì§€ê°‘ v13.1 ì•ˆì •íŒ</title>
<style>
body{font-family:'Pretendard',sans-serif;background:#0a0a0a;color:#fff;margin:0;padding:0;text-align:center}
header{position:fixed;top:0;width:100%;background:#111;padding:10px 0;z-index:1000}
#search{width:90%;max-width:500px;padding:10px;font-size:16px;border:none;border-radius:8px;outline:none}
#spark-container,#ultra-container{margin-top:80px}
.card{background:#1a1a1a;border-radius:12px;margin:10px auto;padding:10px;width:90%;max-width:600px;text-align:left}
.chip{display:inline-block;padding:4px 8px;border-radius:8px;margin-right:6px;font-size:13px}
.chip.buy{background:#007aff}
.chip.sell{background:#ff3b30}
.chip.sl{background:#444}
.chip.risk{background:#888}
h2{margin:10px 0;color:#0ff}
.no-motion{transition:none!important;animation:none!important}
</style>
</head>
<body class="no-motion">
<header>
  <input id="search" placeholder="ì½”ì¸ëª… ë˜ëŠ” ë§ˆì¼“ì½”ë“œ (ì˜ˆ: ì‹œë°”ì´ëˆ„, KRW-SHIB)" />
</header>

<div id="spark-container"></div>
<div id="ultra-container"></div>

<script>
const API_BASE = 'https://satoshi-proxy.mujukno1.workers.dev'; // âœ… ì—°ë™ í™•ì •

// ================= ìŠ¤íŒŒí¬ TOP10 =================
async function loadSparkTop() {
  try {
    const res = await fetch(`${API_BASE}/spark/top`);
    const data = await res.json();
    const container = document.getElementById('spark-container');
    container.innerHTML = '<h2>ğŸ”¥ SPARK TOP10</h2>' +
      data.map(c=>`<div class="card">
        <b>${c.korean_name}</b> (${c.market})<br>
        ì˜ˆì—´ê°•ë„: ${c.spark_score}% / ìƒìŠ¹í™•ë¥ : ${c.prob}%<br>
        ì˜ˆìƒìƒìŠ¹ë¥ : +${c.expected_gain}% / ìœ„í—˜ë„: ${c.risk_level}
      </div>`).join('');
  } catch(e) {
    document.getElementById('spark-container').innerHTML = '<div class="card">SPARK ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨</div>';
  }
}

// ================= ULTRA ì‹œê·¸ë„ =================
async function loadUltra(market) {
  try {
    const res = await fetch(`${API_BASE}/ultra?market=${market}`);
    const d = await res.json();
    const c = document.getElementById('ultra-container');
    c.innerHTML = `<h2>ğŸ’ ${d.korean_name || market} ì‹¤ì‹œê°„ ì‹œê·¸ë„</h2>
      <div class="card">
        <div>í˜„ì¬ê°€: ${d.price}ì›</div>
        <div class="chip buy">ë§¤ìˆ˜ ${d.buy1}ì›</div>
        <div class="chip sell">ìµì ˆ ${d.tp1}ì› / ${d.tp2}ì›</div>
        <div class="chip sl">ì†ì ˆ ${d.sl}ì›</div>
        <div class="chip risk">ìœ„í—˜ë„ ${d.risk_level}</div>
        <div>ì©”ì–´í•œë§ˆë””: ${d.comment || 'ë°ì´í„° ë¶„ì„ì¤‘...'}</div>
      </div>`;
  } catch(e) {
    document.getElementById('ultra-container').innerHTML = '<div class="card">ULTRA ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨</div>';
  }
}

// ================= ê²€ìƒ‰ ì´ë²¤íŠ¸ =================
document.getElementById('search').addEventListener('keydown',e=>{
  if(e.key==='Enter'){
    const val=e.target.value.trim();
    if(!val)return;
    let market=val.toUpperCase().startsWith('KRW-')?val.toUpperCase():`KRW-${val.toUpperCase()}`;
    loadUltra(market);
  }
});

// ================= ì´ˆê¸° ì‹¤í–‰ =================
loadSparkTop();
</script>
</body>
</html>
