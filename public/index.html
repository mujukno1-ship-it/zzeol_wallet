<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>ì©”ì–´ì§€ê°‘ â€” íƒ€ì  ë©”ëª¨ì¥</title>
<style>
body{margin:0;font:14px/1.5 system-ui,-apple-system,Segoe UI,Roboto}
.wrap{max-width:960px;margin:24px auto;padding:0 16px}
h1{font-size:18px;margin:0 0 10px}
.row{display:flex;gap:8px;align-items:center;flex-wrap:wrap;margin:10px 0}
textarea{width:100%;min-height:380px;font:13px/1.5 ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;border:1px solid #ddd;border-radius:10px;padding:12px}
button,select{padding:10px 12px;border-radius:10px;border:1px solid #ccc;background:#f7f7f7;cursor:pointer}
.small{color:#666;font-size:12px}
pre{background:#f4f4f4;border:1px solid #e5e5e5;padding:10px;border-radius:8px;overflow:auto}
</style>
</head>
<body>
<div class="wrap">
  <h1>ğŸ“ íƒ€ì  ë©”ëª¨ì¥ (UI ì†ëŒ€ì§€ ì•Šê³  íƒ€ì ë§Œ êµì²´)</h1>
  <div class="row">
    <label>ì ìš© ì „ëµ ì„ íƒ</label>
    <select id="mode">
      <option value="fixed">fixed (ê¸°ë³¸)</option>
      <option value="volatility">volatility (ë³€ë™ì„± ë³´ì •)</option>
      <option value="custom">custom (ì•„ë˜ ì½”ë“œ ì‚¬ìš©)</option>
    </select>
    <button id="saveMode">ì „ëµ ì €ì¥</button>
    <span class="small">â€» ë©”ì¸ì—ì„œ /strategies/loader.jsê°€ ì´ ê°’ì„ ì½ì–´ ì ìš©</span>
  </div>

  <p class="small">ì•„ë˜ ì½”ë“œë¡œ <b>calcTradeLevels(price, changeRate)</b> í•¨ìˆ˜ë¥¼ ì •ì˜í•˜ì„¸ìš”. ë°˜ë“œì‹œ <code>{buy, sell, stop}</code> ë°˜í™˜.</p>
  <pre>ì˜ˆì‹œ)
function calcTradeLevels(price, changeRate){
  const base = Math.abs(changeRate||0);
  const adj  = base>0.05?1.5:(base>0.02?1.2:1.0);
  return {
    buy:  Math.max(0, Math.floor(price*(1-0.012*adj)*100)/100),
    sell: Math.floor(price*(1+0.012*adj)*100)/100,
    stop: Math.max(0, Math.floor(price*(1-0.025*adj)*100)/100)
  };
}</pre>

  <textarea id="code"></textarea>
  <div class="row">
    <button id="saveCode">ì½”ë“œ ì €ì¥</button>
    <button id="loadSample">ìƒ˜í”Œ ë¶ˆëŸ¬ì˜¤ê¸°</button>
    <span id="msg" class="small"></span>
  </div>
</div>
<script>
const STRATEGY_KEY='selectedStrategy';
const CUSTOM_CODE_KEY='customLevelsCode';

const mode = document.getElementById('mode');
const msg  = document.getElementById('msg');
const code = document.getElementById('code');

(function init(){
  mode.value = localStorage.getItem(STRATEGY_KEY) || 'fixed';
  code.value = localStorage.getItem(CUSTOM_CODE_KEY) || `function calcTradeLevels(price, changeRate){
  // ì—¬ê¸°ì— ì›í•˜ëŠ” ë¡œì§ ì‘ì„±
  return { buy: price*0.98, sell: price*1.02, stop: price*0.97 };
}`;
})();

document.getElementById('saveMode').onclick = function(){
  localStorage.setItem(STRATEGY_KEY, mode.value);
  msg.textContent = 'ì „ëµì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤. (ë©”ì¸ ìƒˆë¡œê³ ì¹¨ ì‹œ ì ìš©)';
  setTimeout(()=>msg.textContent='', 2000);
};

document.getElementById('saveCode').onclick = function(){
  localStorage.setItem(CUSTOM_CODE_KEY, code.value);
  localStorage.setItem(STRATEGY_KEY, 'custom'); // ì½”ë“œ ì €ì¥í•˜ë©´ customìœ¼ë¡œ ì „í™˜
  mode.value = 'custom';
  msg.textContent = 'ì»¤ìŠ¤í…€ ì½”ë“œ ì €ì¥ë¨. (ë©”ì¸ ìƒˆë¡œê³ ì¹¨ ì‹œ ì ìš©)';
  setTimeout(()=>msg.textContent='', 2500);
};

document.getElementById('loadSample').onclick = function(){
  code.value = `function calcTradeLevels(price, changeRate){
  const base = Math.abs(changeRate||0);
  const adj  = base>0.05?1.5:(base>0.02?1.2:1.0);
  return {
    buy:  Math.max(0, Math.floor(price*(1-0.012*adj)*100)/100),
    sell: Math.floor(price*(1+0.012*adj)*100)/100,
    stop: Math.max(0, Math.floor(price*(1-0.025*adj)*100)/100)
  };
}`;
};
</script>
</body>
</html>
